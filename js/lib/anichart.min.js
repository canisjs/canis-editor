!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("anichart",[],e):"object"==typeof exports?exports.anichart=e():t.anichart=e()}(window,function(){return function(t){var e={};function a(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(r,n,function(e){return t[e]}.bind(null,n));return r},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=5)}([function(t,e,a){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._offset=0,this._reference=t.timingRef.previousStart}var e,a,i;return e=t,i=[{key:"transRef",value:function(t){switch(t){case this.timingRef.previousStart:return"previousStart";case this.timingRef.previousEnd:return"previousEnd";case this.timingRef.absolute:return"absolute"}}}],(a=[{key:"calOffsetTime",value:function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;if(0===i.size){var o=0;switch(this.reference){case t.timingRef.previousStart:o=e+this.offset-n;break;case t.timingRef.previousEnd:o=a+this.offset-n;break;case t.timingRef.absolute:o=this.offset+n;break;default:o=e+this.offset-n}return o}var s=this,u=new Map,l=1e6;return"object"===r(this.offset)&&i.forEach(function(t,e){l>parseFloat(t["data-datum"][s.offset.field])&&(l=parseFloat(t["data-datum"][s.offset.field]))}),i.forEach(function(i,o){var c=0;switch(c="number"==typeof s.offset?s.offset:"object"===r(s.offset)?s.offset.minOffset*parseFloat(i["data-datum"][s.offset.field])/l:0,s.reference){case t.timingRef.previousStart:u.set(o,e+c-n);break;case t.timingRef.previousEnd:u.set(o,a+c-n);break;case t.timingRef.absolute:u.set(o,c+n);break;default:u.set(o,e+c-n)}}),u}},{key:"reference",set:function(e){if(void 0!==e){var a=t.transRef(e);Object.keys(t.timingRef).includes(a)?this._reference=e:alert("the 'reference' of TimingSpec has to be one of 'previousStart', 'previousEnd' or 'absolute'. ")}},get:function(){return this._reference}},{key:"offset",set:function(e){void 0!==e&&("number"==typeof e?this._offset=Math.floor(e/(1e3/t.FRAME_RATE))*(1e3/t.FRAME_RATE):"object"===r(e)&&(this._offset=e))},get:function(){return this._offset}}])&&n(e.prototype,a),i&&n(e,i),t}();i.FRAME_RATE=20,i.timingRef={previousStart:"start with previous",previousEnd:"start after previous",absolute:"absolute"};var o=i;e.default=o,t.exports=e.default},function(t,e,a){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,a,o;return e=t,o=[{key:"deepClone",value:function(e){if(!e||1==e)return e;var a=n(e);if("number"==a||"string"==a)return e;var r=Array.isArray(e)?[]:{};if(e instanceof Map){r=new Map;for(var i=0;i<e.keys().length;i++){var o=e.keys()[i];r.set(o,t.deepClone(e.get(o)))}}for(var s in e)e.hasOwnProperty(s)&&(r[s]=t.deepClone(e[s]));return r}},{key:"formatTime",value:function(t){var e=parseInt(t/1e3),a=parseInt(t%1e3/10);return(e<10?"0"+e:""+e)+":"+(a<10?"0"+a:""+a)}},{key:"color2RGB",value:function(t){if(t){if(t=t.toLowerCase(),Array.from(this.colorNames.keys()).includes(t)&&(t=this.colorNames.get(t)),(t=t.replace(/\s/g,"")).indexOf("rgb")>=0){var e=t.substr(t.indexOf("(")+1),a=(e=e.substring(0,e.indexOf(")"))).split(",");return 3===a.length&&(a[3]=255),[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}if(t.indexOf("#")>=0)return this.HEX2RGB(t)}return"none"}},{key:"HEX2RGB",value:function(t){if("#"===t.charAt(0)&&(t=t.substr(1)),t.length<2||t.length>6)return!1;var e,a,r,n=t.split("");if(2===t.length)a=e=parseInt(n[0].toString()+n[1].toString(),16),r=e;else if(3===t.length)e=parseInt(n[0].toString()+n[0].toString(),16),a=parseInt(n[1].toString()+n[1].toString(),16),r=parseInt(n[2].toString()+n[2].toString(),16);else{if(6!==t.length)return!1;e=parseInt(n[0].toString()+n[1].toString(),16),a=parseInt(n[2].toString()+n[3].toString(),16),r=parseInt(n[4].toString()+n[5].toString(),16)}return[e,a,r,255]}},{key:"toJSON",value:function(t){var e={nodeType:(t=t||this).nodeType};t.tagName?e.tagName=t.tagName.toLowerCase():t.nodeName&&(e.nodeName=t.nodeName),t.nodeValue&&(e.nodeValue=t.nodeValue);var a=t.attributes;if(a){e.attr={};for(var r,n=0;n<a.length|(r=a[n]);n++)e.attr[r.nodeName]=r.nodeValue}return e}},{key:"toDOM",value:function(t){var e;switch("string"==typeof t&&(t=JSON.parse(t)),t.nodeType){case 1:e=document.createElementNS("http://www.w3.org/2000/svg",t.tagName);for(var a,r=t.attr||{},i=0;i<Object.keys(r).length|(a=Object.keys(r)[i]);i++){var o="object"===n(r[a])?JSON.stringify(r[a],null,0):r[a];e.setAttributeNS(null,a,o)}break;case 3:e=document.createTextNode(t.nodeValue);break;case 8:e=document.createComment(t.nodeValue);break;case 9:e=document.implementation.createDocument();break;case 10:e=document.implementation.createDocumentType(t.nodeName);break;case 11:e=document.createDocumentFragment();break;default:return e}return e}},{key:"discretizePath",value:function(e){if("path"!==e.tagName)return null;var a=e.attr||{};return a.d?t.discretizeD(a.d,a.fill):null}},{key:"discretizeD",value:function(e,a){for(var r=[],n=/[MmLlHhVvZzCcSsQqTtAa][^MmLlHhVvZzCcSsQqTtAa]*/gi,i=void 0;i=n.exec(e);){var o=r.reduce(function(t,e){return t+e.length},0);r.push(e.slice(o,i.index)),r.push(i[0])}var s=r.map(function(t){var e=t.slice(0,1),a=t.slice(1).split(/[ ,]/).filter(function(t){return t.trim()}).map(function(t){return parseFloat(t)});return e?{command:e,parameters:a}:null}).filter(function(t){return t});if(s.every(function(t){return"MmLlHhVv".includes(t.command)})&&!t.convertColor(a)){var u=[],l=null,c=!0;if(s.forEach(function(t){if(c)if("M"!==t.command){if(!l)return c=!1;if("m"!==t.command){var e=l,a=t.command===t.command.toLowerCase()?l.slice():[0,0];switch(t.command.toLowerCase()){case"l":a=a.map(function(e,a){return e+t.parameters[a]});break;case"h":a[0]+=t.parameters[0],a[1]=e[1];break;case"v":a[1]+=t.parameters[0],a[0]=e[0]}a?(u.push([e,a]),l=a):c=!1}else l=l.map(function(e,a){return e+t.parameters[a]})}else l=t.parameters.slice(-2)}),c)return{type:"lines",data:u}}if(s.every(function(t){return"MmLlAaZz".includes(t.command)})&&s.filter(function(t){return"a"===t.command.toLowerCase()}).length){var f=[],d=null,m=!0;if(s.forEach(function(e){if(m)if("m"!==e.command.toLowerCase()){if(!d)return m=!1;if("z"!==e.command.toLowerCase()){var a=d,r=e.command.toLowerCase()===e.command?d.slice():[0,0];if("a"!==e.command.toLowerCase())return d=r.map(function(t,a){return t+e.parameters[a]});r=r.map(function(t,a){return t+e.parameters[a+5]}),f.push({...t.svgArcToCenterParam.apply(null,a.concat(e.parameters.slice(0,5)).concat(r)),rx:e.parameters[0],ry:e.parameters[1],rotate:e.parameters[2]}),d=r}}else d=e.parameters.slice(-2)}),(f.length<=0||!f.every(function(t){return["cx","cy"].reduce(function(e,a){return e+Math.abs(t[a]-f[0][a])},0)<.1}))&&(m=!1),m){var h=f.reduce(function(t,e){return t?e.rx+e.ry>t.rx+t.ry?e:t:e},null);return{type:"pies",data:{cx:h.cx,cy:h.cy,startAngle:h.startAngle,endAngle:h.endAngle,radius:f.map(function(t){return{rx:t.rx,ry:t.ry,rotate:t.rotate}})}}}}return null}},{key:"radian",value:function(t,e,a,r){var n=t*a+e*r,i=Math.sqrt((t*t+e*e)*(a*a+r*r)),o=Math.acos(n/i);return t*r-e*a<0&&(o=-o),o}},{key:"svgArcToCenterParam",value:function(e,a,r,n,i,o,s,u,l){var c,f,d,m,h,g=2*Math.PI;if(r<0&&(r=-r),n<0&&(n=-n),0==r||0==n)throw Error("rx and ry can not be 0");var p=Math.sin(i),b=Math.cos(i),y=(e-u)/2,v=(a-l)/2,A=(e+u)/2,k=(a+l)/2,T=b*y+p*v,w=b*v-p*y,S=T*T/(r*r)+w*w/(n*n);S>1&&(r*=Math.sqrt(S),n*=Math.sqrt(S));var N=r*n,x=r*w,M=n*T,E=x*x+M*M;if(!E)throw Error("start point can not be same as end point");var F=Math.sqrt(Math.abs((N*N-E)/E));o==s&&(F=-F);var I=F*x/n,C=-F*M/r;c=b*I-p*C+A,f=p*I+b*C+k;var O=(T-I)/r,_=(T+I)/r,R=(w-C)/n,B=(w+C)/n;for(d=t.radian(1,0,O,R),m=t.radian(O,R,-_,-B);m>g;)m-=g;for(;m<0;)m+=g;for(0!=s&&0!=s||(m-=g),h=d+m;h>g;)h-=g;for(;h<0;)h+=g;return{cx:c,cy:f,startAngle:d,deltaAngle:m,endAngle:h,clockwise:1==s||1==s}}},{key:"convertColor",value:function(t,e,a){if("string"!=typeof t)return t;if("none"===t)return null;t=t.trim();var r=null;switch(void 0===a&&(a=e,t.startsWith("#")?e="hex":t.startsWith("rgb")&&(e="rgb")),e){case"rgb":r=t.split("(")[1].split(",").map(function(t){return parseFloat(t)});break;case"hex":r=t.slice(1).match(/.{1,2}/g).map(function(t){return parseInt(t,16)});default:return t}switch(r=r.slice(0,3),a){case"hex":return"#"+r.map(function(t){return t.toString(16).padStart(2,"0")}).join("");case"rgb":return"rgb(".concat(r.join(","),")");default:return t}}},{key:"polarToCartesian",value:function(t,e,a,r){return{x:Math.round(100*(t+a*Math.cos(r)))/100,y:Math.round(100*(e+a*Math.sin(r)))/100}}},{key:"arc",value:function(e,a,r,n,i,o){i=i<0?i+2*Math.PI:i,r=0===r?0:r-1,n+=1;var s=(o=o<0||i>o?o+2*Math.PI:o)-i<=Math.PI?0:1,u=t.polarToCartesian(e,a,n,o),l=t.polarToCartesian(e,a,n,i),c=t.polarToCartesian(e,a,r,o),f=t.polarToCartesian(e,a,r,i),d=!1;return u.x===l.x&&u.y===l.y&&(l.y-=1,f.y-=1,d=!0),d?["M"+u.x,u.y,"A"+n,n,0,s,1,l.x,l.y,"M"+f.x,f.y,"A"+r,r,0,s,0,c.x,c.y+"Z"].join(","):["M"+u.x,u.y,"A"+n,n,0,s,0,l.x,l.y,"L"+f.x,f.y,"A"+r,r,0,s,1,c.x,c.y,"L"+u.x,u.y+"Z"].join(",")}},{key:"domNodeToString",value:function(t){var e=document.createElement("div");return e.appendChild(t),e.innerHTML}},{key:"strToDomNode",value:function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}},{key:"transShape",value:function(e,a,r){if("path"!==e.tagName){var n=!1;(e.getAttribute("x")||e.getAttribute("y"))&&(n=!0,e.setAttribute("x",e.getAttribute("x")?parseFloat(e.getAttribute("x"))+a:a),e.setAttribute("y",e.getAttribute("y")?parseFloat(e.getAttribute("y"))+r:r)),(e.getAttribute("x1")||e.getAttribute("y1")||e.getAttribute("x2")||e.getAttribute("y2"))&&(n=!0,e.setAttribute("x1",e.getAttribute("x1")?parseFloat(e.getAttribute("x1"))+a:a),e.setAttribute("x2",e.getAttribute("x2")?parseFloat(e.getAttribute("x2"))+a:a),e.setAttribute("y1",e.getAttribute("y1")?parseFloat(e.getAttribute("y1"))+r:r),e.setAttribute("y2",e.getAttribute("y2")?parseFloat(e.getAttribute("y2"))+r:r)),(e.getAttribute("cx")||e.getAttribute("cy"))&&(n=!0,e.setAttribute("cx",e.getAttribute("cx")?parseFloat(e.getAttribute("cx"))+a:a),e.setAttribute("cy",e.getAttribute("cy")?parseFloat(e.getAttribute("cy"))+r:r)),n||("circle"===e.tagName?(e.setAttribute("cx",a),e.setAttribute("cy",r)):(e.setAttribute("x",a),e.setAttribute("y",r)))}else if(e.getAttribute("d")){var i=t.setPathDValue(e.getAttribute("d"),!1,a,r);e.setAttribute("d",i)}}},{key:"setPathDValue",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Map;t=t.replace(/(?<=\d)\s(?=[mMlLhHvVcCsSqQtTaAzZ])/g,"").replace(/(?<=[mMlLhHvVcCsSqQtTaA])\s(?=(\d|[-+]))/g,"").replace(/\s/g,",");var i=new RegExp(/[mMlLhHvVcCsSqQtTaA][^mMlLhHvVcCsSqQtTaAzZ]*/g),o="",s=t.match(i);if(s){var u=s[0].substring(0,1),l="0",c="0";if("m"===u||"M"===u){var f=s[0].substring(1).split(",");l=f[0],c=f[1]}for(var d=0;d<s.length;d++){var m=s[d].substring(0,1),h=s[d].substring(1);switch(o+=m,m){case"H":o=this.calNumTrans(o,n,d,m,h,e,l,a);break;case"h":o=this.calNumTrans(o,n,d,m,h,e,"0",0);break;case"V":o=this.calNumTrans(o,n,d,m,h,e,c,r);break;case"v":o=this.calNumTrans(o,n,d,m,h,e,"0",0);break;case"M":case"L":case"T":case"C":case"S":case"Q":for(var g=h.split(","),p=0;p<g.length;p++)o=p%2==0?this.calNumTrans(o,n,d,m,g[p],e,l,a):this.calNumTrans(o,n,d,m,g[p],e,c,r),p!==g.length-1&&(o+=",");break;case"m":case"l":case"t":case"c":case"s":case"q":for(var b=h.split(","),y=0;y<b.length;y++)o=this.calNumTrans(o,n,d,m,b[y],e,"0",0),y!==b.length-1&&(o+=",");break;case"A":for(var v=h.split(","),A=0;A<v.length;A++)A===v.length-2?(o=this.calNumTrans(o,n,d,m,v[A],e,parseFloat(l)+1,a),o+=","):A===v.length-1?o=this.calNumTrans(o,n,d,m,v[A],e,parseFloat(c)+1,r):o+=v[A]+",";break;case"a":for(var k=h.split(","),T=0;T<k.length;T++)T===k.length-2?(o=this.calNumTrans(o,n,d,m,k[T],e,"1",0),o+=","):T===k.length-1?o=this.calNumTrans(o,n,d,m,k[T],e,"1",0):o+=k[T]+","}}"z"!==t.charAt(t.length-1)&&"Z"!==t.charAt(t.length-1)||(o+="Z")}return o}},{key:"calNumTrans",value:function(t,e,a,r,n,i,o,s){if(r=r.toLowerCase(),i)if(void 0!==e.get(r)){for(var u=e.get(r),l=!1,c=0;c<u.length;c++)if(u[c].cmdIdx===a){t+=o,l=!0;break}l||(t+=n)}else t+=n;else t+=parseFloat(n)+s;return t}},{key:"calTransD",value:function(t,e,a,r,n){t=t.replace(/(?<=\d)\s(?=[mMlLhHvVcCsSqQtTaAzZ])/g,"").replace(/(?<=[mMlLhHvVcCsSqQtTaA])\s(?=(\d|[-+]))/g,"").replace(/\s/g,","),e=e.replace(/(?<=\d)\s(?=[mMlLhHvVcCsSqQtTaAzZ])/g,"").replace(/(?<=[mMlLhHvVcCsSqQtTaA])\s(?=(\d|[-+]))/g,"").replace(/\s/g,",");var i="";if(0===a)i=t;else if(1===a)i=e;else for(var o=0,s=r.length;o<s;o++)i+=(0===o?"M":"L")+((n[o][0]-r[o][0])*a+r[o][0])+","+((n[o][1]-r[o][1])*a+r[o][1]);return"z"!==t.charAt(t.length-1)&&"Z"!==t.charAt(t.length-1)||(i+="Z"),i}},{key:"arcTransition",value:function(t,e,a,r,n,i){var o=function(t,e){return e<t?function(){throw"startAngle should smaller than endAngle"}():null};o(t,e),o(a,r);var s=function(t,e){return e-2*Math.PI*Math.floor((e-t)/Math.PI/2)};e=s(t,e),a=s(t,a),r=s(a,r),r=s(a-=Math.abs(a-t)+Math.abs(r-e)<2*Math.PI?0:2*Math.PI,r);var u=i||function(t,e,a){return a*(e-t)+t};return[u(t,a,n),u(e,r,n)]}},{key:"findDiffCmds",value:function(e){var a=new Map;return e.forEach(function(e,r){for(var n=[],i=0;i<e.length;i++)void 0!==e[i]&&n.push(e[i].d?e[i].d:"m0,0");n.length>0&&t.compareD(n,a)}),a}},{key:"compareD",value:function(t,e){for(var a=new RegExp(/[mlhvcsqta][^mlhvcsqtaz]*/g),n=t[0],i=(n=(n=n.toLowerCase()).replace(/(?<=\d)\s(?=[mlhvcsqtaz])/g,"").replace(/(?<=[mlhvcsqta])\s(?=(\d|[-+]))/g,"").replace(/\s/g,",")).match(a),o=1;o<t.length;o++)for(var s=t[o],u=(s=(s=s.toLowerCase()).replace(/(?<=\d)\s(?=[mlhvcsqtaz])/g,"").replace(/(?<=[mlhvcsqta])\s(?=(\d|[-+]))/g,"").replace(/\s/g,",")).match(a),l=0;l<i.length;l++)if(void 0===u[l]){var c=i[l].substring(0,1);void 0===e.get(c)&&e.set(c,[]);var f={};f.cmdIdx=l,f.diffAttrIdxs=[];for(var d=i[l].substring(1).split(","),m=0;m<d.length;m++)f.diffAttrIdxs.push(m);e.get(c).push(f)}else{var h=u[l].substring(0,1),g=u[l].substring(1),p=i[l].substring(1);if(g!==p){void 0===e.get(h)&&e.set(h,[]);var b={};b.cmdIdx=l,b.diffAttrIdxs=[];for(var y=g.split(","),v=p.split(","),A=0;A<y.length;A++)Math.floor(1e3*parseFloat(y[A]))!==Math.floor(1e3*parseFloat(v[A]))&&b.diffAttrIdxs.push(A);for(var k=!1,T=0;T<e.get(h).length;T++)if(e.get(h)[T].cmdIdx===b.cmdIdx){k=!0,e.get(h)[T].diffAttrIdxs=[].concat(r(new Set([].concat(r(e.get(h)[T].diffAttrIdxs),r(b.diffAttrIdxs)))));break}k||e.get(h).push(b)}}}},{key:"getTransformAttrs",value:function(t){var e=t.getAttribute("transform");if(e){e=(e=e.replace(/translate|scale|rotate|\s/g,function(t){return" "===t?"":"@"+t})).replace(/(^@*)|(@*$)/g,"").split("@");for(var a="",r="",n=0;n<e.length;n++)e[n].indexOf("translate")>=0?r=e[n]:e[n].indexOf("scale")>=0&&(a=e[n]);var i=["0","0"],o="1";return""!==r&&(i=r.replace(/translate\(| |\)/g,"").split(",")),""!==a&&(o=a.replace(/scale\(| |\)/g,"")),{transNums:[parseFloat(i[0]),parseFloat(i[1])],scaleNum:parseFloat(o)}}return{transNums:[0,0],scaleNum:1}}},{key:"checkHTML",value:function(t){return/<[^>]+>/g.test(t)}}],(a=null)&&i(e.prototype,a),o&&i(e,o),t}();o.colorNames=new Map([["aliceblue","#f0f8ff"],["antiquewhite","#faebd7"],["aqua","#00ffff"],["aquamarine","#7fffd4"],["azure","#f0ffff"],["beige","#f5f5dc"],["bisque","#ffe4c4"],["black","#000000"],["blanchedalmond","#ffebcd"],["blue","#0000ff"],["blueviolet","#8a2be2"],["brown","#a52a2a"],["burlywood","#deb887"],["cadetblue","#5f9ea0"],["chartreuse","#7fff00"],["chocolate","#d2691e"],["coral","#ff7f50"],["cornflowerblue","#6495ed"],["cornsilk","#fff8dc"],["crimson","#dc143c"],["cyan","#00ffff"],["darkblue","#00008b"],["darkcyan","#008b8b"],["darkgoldenrod","#b8860b"],["darkgray","#a9a9a9"],["darkgrey","#a9a9a9"],["darkgreen","#006400"],["darkkhaki","#bdb76b"],["darkmagenta","#8b008b"],["darkolivegreen","#556b2f"],["darkorange","#ff8c00"],["darkorchid","#9932cc"],["darkred","#8b0000"],["darksalmon","#e9967a"],["darkseagreen","#8fbc8f"],["darkslateblue","#483d8b"],["darkslategray","#2f4f4f"],["darkslategrey","#2f4f4f"],["darkturquoise","#00ced1"],["darkviolet","#9400d3"],["deeppink","#ff1493"],["deepskyblue","#00bfff"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1e90ff"],["firebrick","#b22222"],["floralwhite","#fffaf0"],["forestgreen","#228b22"],["fuchsia","#ff00ff"],["gainsboro","#dcdcdc"],["ghostwhite","#f8f8ff"],["gold","#ffd700"],["goldenrod","#daa520"],["gray","#808080"],["grey","#808080"],["green","#008000"],["greenyellow","#adff2f"],["honeydew","#f0fff0"],["hotpink","#ff69b4"],["indianred ","#cd5c5c"],["indigo  ","#4b0082"],["ivory","#fffff0"],["khaki","#f0e68c"],["lavender","#e6e6fa"],["lavenderblush","#fff0f5"],["lawngreen","#7cfc00"],["lemonchiffon","#fffacd"],["lightblue","#add8e6"],["lightcoral","#f08080"],["lightcyan","#e0ffff"],["lightgoldenrodyellow","#fafad2"],["lightgray","#d3d3d3"],["lightgrey","#d3d3d3"],["lightgreen","#90ee90"],["lightpink","#ffb6c1"],["lightsalmon","#ffa07a"],["lightseagreen","#20b2aa"],["lightskyblue","#87cefa"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#b0c4de"],["lightyellow","#ffffe0"],["lime","#00ff00"],["limegreen","#32cd32"],["linen","#faf0e6"],["magenta","#ff00ff"],["maroon","#800000"],["mediumaquamarine","#66cdaa"],["mediumblue","#0000cd"],["mediumorchid","#ba55d3"],["mediumpurple","#9370db"],["mediumseagreen","#3cb371"],["mediumslateblue","#7b68ee"],["mediumspringgreen","#00fa9a"],["mediumturquoise","#48d1cc"],["mediumvioletred","#c71585"],["midnightblue","#191970"],["mintcream","#f5fffa"],["mistyrose","#ffe4e1"],["moccasin","#ffe4b5"],["navajowhite","#ffdead"],["navy","#000080"],["oldlace","#fdf5e6"],["olive","#808000"],["olivedrab","#6b8e23"],["orange","#ffa500"],["orangered","#ff4500"],["orchid","#da70d6"],["palegoldenrod","#eee8aa"],["palegreen","#98fb98"],["paleturquoise","#afeeee"],["palevioletred","#db7093"],["papayawhip","#ffefd5"],["peachpuff","#ffdab9"],["peru","#cd853f"],["pink","#ffc0cb"],["plum","#dda0dd"],["powderblue","#b0e0e6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#ff0000"],["rosybrown","#bc8f8f"],["royalblue","#4169e1"],["saddlebrown","#8b4513"],["salmon","#fa8072"],["sandybrown","#f4a460"],["seagreen","#2e8b57"],["seashell","#fff5ee"],["sienna","#a0522d"],["silver","#c0c0c0"],["skyblue","#87ceeb"],["slateblue","#6a5acd"],["slategray","#708090"],["slategrey","#708090"],["snow","#fffafa"],["springgreen","#00ff7f"],["steelblue","#4682b4"],["tan","#d2b48c"],["teal","#008080"],["thistle","#d8bfd8"],["tomato","#ff6347"],["turquoise","#40e0d0"],["violet","#ee82ee"],["wheat","#f5deb3"],["white","#ffffff"],["whitesmoke","#f5f5f5"],["yellow","#ffff00"],["yellowgreen","#9acd32"]]);var s=o;e.default=s,t.exports=e.default},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=u(a(3)),n=u(a(6)),i=u(a(7)),o=u(a(0)),s=u(a(1));function u(t){return t&&t.__esModule?t:{default:t}}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var a=[],r=!0,n=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(a.push(o.value),!e||a.length!==e);r=!0);}catch(t){n=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}return a}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=m(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))).chartIdx,t.selection,t.grouping=new i.default,t.actions=[],t.domMarks=new Map,t.animationStartTime=1e6,t.animationEndTime=0,t}var a,u,g;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,o.default),a=e,g=[{key:"renderAnimation",value:function(){var t=this;this.allMarkAni.forEach(function(e,a){t.wholeEndTime<e.startTime+e.totalDuration&&(t.wholeEndTime=e.startTime+e.totalDuration);for(var r,i=new Map,o=new Map,s=0;s<e.actionAttrs.length|(r=e.actionAttrs[s]);s++)r.type===n.default.actionTargets.mark?void 0===o.get(r.attribute.attrName)?o.set(r.attribute.attrName,[r]):o.get(r.attribute.attrName).push(r):r.type===n.default.actionTargets.mask?void 0===i.get(r.attribute.attrName)?i.set(r.attribute.attrName,[r]):i.get(r.attribute.attrName).push(r):console.log("we have some action with no type !!!!!");i.forEach(function(t,a){var r=new n.default;r.type=n.default.actionTargets.mask,r.chartIdx=t[0].chartIdx,r.animationType=t[0].animationType,r.startTime=0,r.duration=t[0].startTime,r.attribute={attrName:t[0].attribute.attrName,from:t[0].attribute.from,to:t[0].attribute.from},e.actionAttrs.push(r);for(var i=0;i<t.length;i++){var o=new n.default;o.type=n.default.actionTargets.mask,o.chartIdx=t[i].chartIdx,o.animationType=t[i].animationType,o.startTime=t[i].startTime+t[i].duration,i===t.length-1?o.duration="wholeEnd":o.duration=t[i+1].startTime-t[i].startTime-t[i].duration,o.attribute={attrName:t[i].attribute.attrName,from:t[i].attribute.to,to:t[i].attribute.to},e.actionAttrs.push(o)}}),o.forEach(function(t,a){var r=new n.default;r.type=n.default.actionTargets.mark,r.animationType=t[0].animationType,r.startTime=0,r.duration=t[0].startTime,r.attribute={attrName:t[0].attribute.attrName,from:t[0].attribute.from,to:t[0].attribute.from},e.actionAttrs.push(r);for(var i=0;i<t.length;i++){var o=new n.default;o.type=n.default.actionTargets.mark,o.animationType=t[i].animationType,o.startTime=t[i].startTime+t[i].duration,i===t.length-1?o.duration="wholeEnd":o.duration=t[i+1].startTime-t[i].startTime-t[i].duration,o.attribute={attrName:t[i].attribute.attrName,from:t[i].attribute.to,to:t[i].attribute.to},e.actionAttrs.push(o)}})}),console.log("The duration of the generated animation is: "+this.wholeEndTime+"ms"),this.allMarkAni.forEach(function(e,a){for(var r,n=0;n<e.actionAttrs.length|(r=e.actionAttrs[n]);n++)"wholeEnd"===r.duration&&(r.duration=t.wholeEndTime-r.startTime)})}},{key:"renderFrame",value:function(t){var a=[];return this.allMarkAni.forEach(function(r,n){for(var i,o=new Map,s=0;s<r.actionAttrs.length|(i=r.actionAttrs[s]);s++)if(i.attribute.from!==i.attribute.to||0!==i.duration){var u=e.calAttrValue(i,n,t);u!==(t>=0?e.calAttrValue(i,n,t-1):"")&&(i.startTime<=t&&i.startTime+i.duration>=t?o.set(i.attribute.attrName,{type:i.type,animationType:i.animationType,endTime:i.startTime+i.duration,attrName:i.attribute.attrName,value:u}):i.startTime+i.duration<t&&void 0!==o.get(i.attribute.attrName)&&o.get(i.attribute.attrName).endTime<i.startTime+i.duration&&o.set(i.attribute.attrName,{type:i.type,animationType:i.animationType,endTime:i.startTime+i.duration,attrName:i.attribute.attrName,value:u}))}o.size>0&&a.push([n,o])}),a}},{key:"calAttrValue",value:function(t,e,a){var r,i=t.chartIdx;if(t.startTime<=a&&t.startTime+t.duration>=a){var o=parseFloat(a-t.startTime)/parseFloat(t.duration),u=this.calRatio(o,t.easing);switch(t.attribute.attrName){case"fill":case"stroke":if(t.type===n.default.actionTargets.mark&&Array.isArray(t.attribute.to)){for(var l,c,f=0;f<t.attribute.to.length;f++)if(t.attribute.to[f][0]===e&&"string"==typeof t.attribute.to[f][1]){l=t.attribute.from[f][1],c=t.attribute.to[f][1];break}var d=s.default.color2RGB(l),m=s.default.color2RGB(c);r="rgb("+(parseInt((m[0]-d[0])*u)+d[0])+","+(parseInt((m[1]-d[1])*u)+d[1])+","+(parseInt((m[2]-d[2])*u)+d[2])+")"}break;case"textContent":if(t.type===n.default.actionTargets.mark&&Array.isArray(t.attribute.to)){for(var h=0,g=0;g<t.attribute.to.length;g++)if(t.attribute.to[g][0]===e&&(!isNaN(t.attribute.to[g][1])||"string"==typeof t.attribute.to[g][1])){h=t.attribute.to[g][1];break}r=h}break;case"width":case"height":case"r":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var p=0,b=0,y=0;y<t.attribute.to.length;y++)if(t.attribute.to[y][0]===e&&!isNaN(t.attribute.from[y][1])&&!isNaN(t.attribute.to[y][1])){p=t.attribute.from[y][1],b=t.attribute.to[y][1];break}r=p+(b-p)*u}else{var v=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);r=0-(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(0-v)}else{var A=parseFloat(this.minStatus.get(t.attribute.attrName)),k=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);r=A<0?A+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(k-A):(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*k}break;case"y":case"y1":case"y2":case"cy":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var T=0,w=0,S=0;S<t.attribute.to.length;S++)if(t.attribute.to[S][0]===e&&!isNaN(t.attribute.from[S][1])&&!isNaN(t.attribute.to[S][1])){T=t.attribute.from[S][1],w=t.attribute.to[S][1];break}r=T+(w-T)*u}else{var N=this.startY,x=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);r=N-(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(N-x)}else t.type===n.default.actionTargets.mask&&(r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName])-1+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(parseFloat(this.finalStatus.get(e)[i].height)+2));break;case"x":case"x1":case"x2":case"cx":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var M=0,E=0,F=0;F<t.attribute.to.length;F++)if(t.attribute.to[F][0]===e&&!isNaN(t.attribute.from[F][1])&&!isNaN(t.attribute.to[F][1])){M=t.attribute.from[F][1],E=t.attribute.to[F][1];break}r=M+(E-M)*u}else{var I=this.startX,C=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);r=I+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(C-I)}else t.type===n.default.actionTargets.mask&&(r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName])-1+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(parseFloat(this.finalStatus.get(e)[i].width)+2));break;case"startAngle":var O,_=parseFloat(this.finalStatus.get(e)[i].startAngle),R=parseFloat(this.finalStatus.get(e)[i].endAngle),B=_<0?_+2*Math.PI:_,j=R<0||B>R?R+2*Math.PI:R;O=j>B?B+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(j-B):B+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(2*Math.PI-B+j),r={cx:parseFloat(this.finalStatus.get(e)[i].cx),cy:parseFloat(this.finalStatus.get(e)[i].cy),innerRadius:parseFloat(this.finalStatus.get(e)[i].innerRadius),outterRadius:parseFloat(this.finalStatus.get(e)[i].outterRadius)+2,startAngle:O,endAngle:parseFloat(this.finalStatus.get(e)[i].endAngle)};break;case"innerRadius":var L=parseFloat(this.finalStatus.get(e)[i].innerRadius),P=parseFloat(this.finalStatus.get(e)[i].outterRadius),q=(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(P-L);r=q<0?{cx:parseFloat(this.finalStatus.get(e)[i].cx),cy:parseFloat(this.finalStatus.get(e)[i].cy),innerRadius:parseFloat(this.finalStatus.get(e)[i].innerRadius)+2,outterRadius:parseFloat(this.finalStatus.get(e)[i].outterRadius)-q+2,startAngle:parseFloat(this.finalStatus.get(e)[i].startAngle),endAngle:parseFloat(this.finalStatus.get(e)[i].endAngle)}:{cx:parseFloat(this.finalStatus.get(e)[i].cx),cy:parseFloat(this.finalStatus.get(e)[i].cy),innerRadius:parseFloat(this.finalStatus.get(e)[i].innerRadius)+q+2,outterRadius:parseFloat(this.finalStatus.get(e)[i].outterRadius)+2,startAngle:parseFloat(this.finalStatus.get(e)[i].startAngle),endAngle:parseFloat(this.finalStatus.get(e)[i].endAngle)};break;case"stroke-dashoffset":var D=parseFloat(this.finalStatus.get(e)[i]["stroke-dasharray"]);r=0-(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(0-D);break;case"d":if(t.type===n.default.actionTargets.mark&&Array.isArray(t.attribute.to)){for(var H="",V="",Q="",z="",G=0;G<t.attribute.to.length;G++)if(t.attribute.to[G][0]===e&&t.attribute.from[G][1]&&t.attribute.to[G][1]){H=t.attribute.from[G][1],V=t.attribute.to[G][1],Q=t.attribute.from[G][2],z=t.attribute.to[G][2];break}r=s.default.calTransD(H,V,u,Q,z)}break;default:var Z=parseFloat(this.minStatus.get(t.attribute.attrName)),X=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);r=Z<0?Z+(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*(X-Z):(parseFloat(t.attribute.to-t.attribute.from)*u+t.attribute.from)*X}}else if(t.startTime+t.duration<a)switch(t.attribute.attrName){case"fill":case"stroke":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var J=0;J<t.attribute.to.length;J++)if(t.attribute.to[J][0]===e&&"string"==typeof t.attribute.to[J][1]){r=t.attribute.to[J][1];break}}else r=this.finalStatus.get(e)[i][t.attribute.attrName];break;case"textContent":if(t.type===n.default.actionTargets.mark&&Array.isArray(t.attribute.to)){for(var W=0,Y=0;Y<t.attribute.to.length;Y++)if(t.attribute.to[Y][0]===e&&(!isNaN(t.attribute.to[Y][1])||"string"==typeof t.attribute.to[Y][1])){W=t.attribute.to[Y][1];break}r=W}break;case"width":case"height":case"r":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var $=0,K=0;K<t.attribute.to.length;K++)if(t.attribute.to[K][0]===e){$=t.attribute.to[K][1];break}r=$}else r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);else r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);break;case"y":case"y1":case"y2":case"cy":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var U=0,tt=0;tt<t.attribute.to.length;tt++)if(t.attribute.to[tt][0]===e){U=t.attribute.to[tt][1];break}r=U}else r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);else t.type===n.default.actionTargets.mask&&(r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName])+parseFloat(this.finalStatus.get(e)[i].height));break;case"x":case"x1":case"x2":case"cx":if(t.type===n.default.actionTargets.mark)if(Array.isArray(t.attribute.to)){for(var et=0,at=0;at<t.attribute.to.length;at++)if(t.attribute.to[at][0]===e){et=t.attribute.to[at][1];break}r=et}else r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]);else t.type===n.default.actionTargets.mask&&(r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName])+parseFloat(this.finalStatus.get(e)[i].height));break;case"startAngle":case"innerRadius":r={cx:parseFloat(this.finalStatus.get(e)[i].cx),cy:parseFloat(this.finalStatus.get(e)[i].cy),innerRadius:parseFloat(this.finalStatus.get(e)[i].innerRadius),outterRadius:parseFloat(this.finalStatus.get(e)[i].outterRadius),startAngle:parseFloat(this.finalStatus.get(e)[i].startAngle),endAngle:parseFloat(this.finalStatus.get(e)[i].endAngle)};break;default:void 0!==this.finalStatus.get(e)[i]&&(r=parseFloat(this.finalStatus.get(e)[i][t.attribute.attrName]))}return r}},{key:"calRatio",value:function(t,e){var a=0;switch(e){case n.default.easingType.easeLinear:a=t;break;case n.default.easingType.easeInQuad:a=this.easeFuncs.easeInQuad(t);break;case n.default.easingType.easeOutQuad:a=this.easeFuncs.easeOutQuad(t);break;case n.default.easingType.easeInOutQuad:a=this.easeFuncs.easeInOutQuad(t);break;case n.default.easingType.easeInCubic:a=this.easeFuncs.easeInCubic(t);break;case n.default.easingType.easeOutCubic:a=this.easeFuncs.easeOutCubic(t);break;case n.default.easingType.easeInOutCubic:a=this.easeFuncs.easeInOutCubic(t);break;case n.default.easingType.easeOutBounce:a=this.easeFuncs.easeOutBounce(t)}return a}},{key:"resetAll",value:function(){this.wholeEndTime=0,this.allMarkAni.clear(),this.minStatus.clear(),this.finalStatus.clear(),this.frames.clear()}}],(u=[{key:"translate",value:function(t,e){if(this.checkFormat(t)&&(this.chartIdx=t.chartIdx,this.selection=t.selection,this.reference=t.reference,this.offset=t.offset,void 0!==t.grouping&&this.grouping.initGrouping(t.grouping),void 0!==t.actions))for(var a,i=0;i<t.actions.length|(a=t.actions[i]);i++){a.chartIdx=t.chartIdx;for(var o,s=n.default.transToVisualAttrAction(a,t.chartIdx,e,r.default.dataTrans),u=0;u<s.length|(o=s[u]);u++){var l=new n.default;l.initAction(o),this.actions.push(l)}}}},{key:"checkFormat",value:function(t){return!!Object.keys(t).includes("selection")||(alert("illegal format, no 'selection' is defined "),!1)}},{key:"calAniTime",value:function(t,a){for(var r,i=this,o=new Map,s=0;s<t.length|(r=t[s]);s++){for(var u,d=new Map,m=0;m<this.actions.length|(u=this.actions[m]);m++)if("object"===f(u.duration)){var h=this.domMarks.get(r)["data-datum"],g=parseFloat(h[u.duration.field]),p=void 0===u.duration.minDuration?300:u.duration.minDuration;d.set(u.duration.field,[g,p])}o.set(r,d)}for(var b,y=c(n.default.calActionDuration(this.actions,o,this.domMarks),3),v=y[0],A=y[1],k=y[2],T=this.grouping.arrangeOrder(t,this.domMarks),w=new Map,S=new Map,N=0;N<T.length|(b=T[N]);N++){for(var x,M={},E=0;E<e.visualAttrs.length|(x=e.visualAttrs[E]);E++){if(void 0===this.domMarks.get(b)[x])switch(x){case"opacity":M[x]=1;break;case"width":M[x]=this.domMarks.get(b).bbWidth;break;case"height":M[x]=this.domMarks.get(b).bbHeight;break;case"x":M[x]=this.domMarks.get(b).bbX;break;case"y":M[x]=this.domMarks.get(b).bbY;break;case"cx":M[x]=this.domMarks.get(b).bbX+this.domMarks.get(b).bbWidth/2;break;case"cy":M[x]=this.domMarks.get(b).bbY+this.domMarks.get(b).bbHeight/2;break;case"innerRadius":M[x]=0;break;case"outterRadius":M[x]=Math.sqrt(Math.pow(this.domMarks.get(b).bbWidth/2,2)+Math.pow(this.domMarks.get(b).bbHeight/2,2));break;case"startAngle":M[x]=0;break;case"endAngle":M[x]=2*Math.PI}else M[x]=this.domMarks.get(b)[x];""!==M[x]&&(void 0===e.minStatus.get(x)?e.minStatus.set(x,M[x]):parseFloat(e.minStatus.get(x))>parseFloat(M[x])&&e.minStatus.set(x,M[x]))}void 0===e.finalStatus.get(b)&&e.finalStatus.set(b,[]),e.finalStatus.get(b).push(M),w.set(b,{startTime:0,totalDuration:v.get(b),actionAttrs:[]}),S.set(b,"allMarks")}this.grouping.calTimeInGrouping(w,this.domMarks);var F=1e4;w.forEach(function(t,e){t.startTime<F&&(F=t.startTime)});var I=void 0===a?this.calOffsetTime(0,0,F,this.domMarks):this.calOffsetTime(a.animationStartTime,a.animationEndTime,F,this.domMarks);w.forEach(function(t,e){var a={startTime:t.startTime+I.get(e),totalDuration:t.totalDuration,actionAttrs:[]};a.startTime<i.animationStartTime&&(i.animationStartTime=a.startTime),a.startTime+a.totalDuration>i.animationEndTime&&(i.animationEndTime=a.startTime+a.totalDuration);for(var r,o=0;o<k.length|(r=k[o]);o++){for(var s,u=new n.default,l=Object.keys(r),c=0;c<l.length|(s=l[c]);c++)if(u[s]=r[s],"_duration"===s&&"object"===f(r[s])){var d=i.domMarks.get(e)["data-datum"],m=A.get(r[s].field);u[s]=r[s].minDuration*parseFloat(d[r[s].field])/m}else"offsetStart"===s&&(u[s]=r[s].get(e));a.actionAttrs.push(u)}w.set(e,a)}),w.forEach(function(t,a){for(var r=0;r<t.actionAttrs.length;r++)t.actionAttrs[r].startTime=t.startTime+t.actionAttrs[r].offsetStart;if(void 0===e.allMarkAni.get(a))e.allMarkAni.set(a,t);else{var n=e.allMarkAni.get(a).startTime,i=n+e.allMarkAni.get(a).totalDuration;e.allMarkAni.get(a).startTime=n<t.startTime?n:t.startTime;var o=t.startTime+t.totalDuration;i=i>o?i:o,e.allMarkAni.get(a).totalDuration=i-e.allMarkAni.get(a).startTime,e.allMarkAni.get(a).actionAttrs=[].concat(l(e.allMarkAni.get(a).actionAttrs),l(t.actionAttrs))}})}}])&&d(a.prototype,u),g&&d(a,g),e}();g.visualAttrs=["x","y","cx","cy","innerRadius","outterRadius","startAngle","endAngle","width","height","opacity","fill","stroke","content","stroke-dasharray","stroke-dashoffset"],g.startY=0,g.startX=0,g.endX=0,g.wholeEndTime=0,g.minStatus=new Map,g.finalStatus=new Map,g.allMarkAni=new Map,g.frames=new Map,g.easeFuncs={easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-t*(t-2)},easeInOutQuad:function(t){return t/2<1?.5*t*t:-(--t*(t-2)-1)/2},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return(t-=1)*t*t+1},easeInOutCubic:function(t){return(t/=.5)<1?t*t*t/2:((t-=2)*t*t+2)/2},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}};var p=g;e.default=p,t.exports=e.default},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a(1)),n=i(a(4));function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.source=a}var e,a,i;return e=t,i=[{key:"chartPreProcessing",value:function(t){for(var e=[],a=0;a<t.length;a++){var r=t[a];if(void 0!==r.start&&void 0!==r.end){var n=parseInt(r.start),i=parseInt(r.end);if(i<n){console.log("wrong start and end file index ");continue}for(var o=r.source.split("/"),s=void 0===r.id?o[o.length-1]:r.id,u=n;u<=i;u++)e.push({id:s+u,source:r.source+u+".dsvg"})}else e.push(r)}return e}},{key:"loadCharts",value:function(e,a){var r=new Map;t.charts=[];for(var n=[],i=0;i<e.length;i++){var o=new XMLHttpRequest,s="file:"===document.location.protocol?0:200,u=void 0;if(o.open("GET",e[i].source,!1),o.overrideMimeType("text/html;charset=utf-8"),o.send(null),o.status===s){var l=document.createElement("div");l.innerHTML=o.responseText,u=l.children[0],t.charts.push(u),r.set(e[i].id,t.charts.length-1)}else 404===o.status&&(n.unshift(i),console.log("can not find "+e[i].source+" ! Please check the url."))}for(var c=0;c<n.length;c++)e.slice(n[c],1);void 0!==a&&t.facetViews(r,a)}},{key:"removeTransAndMerge",value:function(){for(var e=0;e<t.charts.length;e++)t.charts[e].setAttribute("trans","0,0"),t.removeTransitions(t.charts[e].children[0]);return t.mergeCharts()}},{key:"facetViews",value:function(e,a){if(a.views.length>0){for(var r=[],n=0;n<a.views[0].frames.length;n++){for(var i=[],o=0;o<a.views.length;o++){var s=a.views[o].frames[n];void 0!==e.get(s)?i.push(t.charts[e.get(s)].cloneNode(!0)):console.log("chart name "+s+" is undefined !")}i.length===a.views.length&&r.push(i)}t.combineCharts(a.type,a.views.length,r)}}},{key:"combineCharts",value:function(e,a,i){for(var o=[],s=0;s<i.length;s++){var u=i[s],l=parseFloat(u[0].getAttribute("width")),c=parseFloat(u[0].getAttribute("height")),f=u[0].getAttribute("viewBox").split(" "),d=parseFloat(f[2]),m=parseFloat(f[3]),h=r.default.getTransformAttrs(u[0].children[0]);switch(u[0].children[0].setAttribute("transform","translate("+h.transNums[0]+","+h.transNums[1]+") scale("+h.scaleNum/a+")"),e){case n.default.facetType.row:u[0].setAttribute("height",c+20*u.length),u[0].setAttribute("viewBox","0 0 "+d+" "+(m+20*u.length));break;case n.default.facetType.col:u[0].setAttribute("width",l+20*u.length),u[0].setAttribute("viewBox","0 0 "+(d+20*u.length)+" "+m)}for(var g=function(t){var a=u[t],i=a.querySelectorAll(".mark");if([].forEach.call(i,function(e){var a=parseInt(e.getAttribute("id").substring(4));e.setAttribute("id","mark"+(a+1e5*t)),e.classList.add("facet"+t)}),t>0)for(var o=a.children[0].children,s=0;s<o.length;s++){var l=o[s],c=r.default.getTransformAttrs(l);switch(e){case n.default.facetType.row:l.setAttribute("transform","translate("+c.transNums[0]+","+(c.transNums[1]+(m+20)*t)+") scale("+c.scaleNum+")");break;case n.default.facetType.col:l.setAttribute("transform","translate("+(c.transNums[0]+(d+20)*t)+","+c.transNums[1]+") scale("+c.scaleNum+")")}u[0].children[0].appendChild(l)}},p=0;p<u.length;p++)g(p);o.push(u[0])}t.charts=o}},{key:"mergeCharts",value:function(){for(var e=new Set,a=new Map,n=new Map,i=["x","y","cx","cy","x1","y1","x2","y2","d","r","width","height","textContent","fill","stroke"],o={},s=0;s<i.length;s++)o[i[s]]=null;for(var u=function(r){var s=t.charts[r].querySelectorAll(".mark");s.length>0&&[].forEach.call(s,function(s){var u=s.getAttribute("id");e.add(u);for(var l={},c=0;c<i.length;c++)l[i[c]]="textContent"===i[c]?s.innerHTML:s.getAttribute(i[c]);void 0===a.get(u)&&a.set(u,new Array(t.charts.length).fill(o)),a.get(u)[r]=l,n.set(u,s.outerHTML)})},l=0;l<t.charts.length;l++)u(l);t.changedAttrs=[];var c=r.default.deepClone(i);a.forEach(function(e,a){for(var r=0;r<c.length;r++){for(var n=!0,i=void 0,o=0;o<e.length;o++)if(void 0!==e[o]){i=e[o];break}for(var s=0;s<e.length;s++)if(void 0!==e[s]&&e[s][c[r]]!==i[c[r]]){t.changedAttrs.push(c[r]),n=!1;break}if(!n){c.splice(r,1);break}}});var f=new Map;for(t.changedAttrs.indexOf("d")>=0&&(f=r.default.findDiffCmds(a)),e=Array.from(e),t.markDoms.clear(),l=0;l<t.charts.length;l++)for(var d=0;d<e.length;d++)if(0===t.charts[l].querySelectorAll("#"+e[d]).length){var m=n.get(e[d]),h=document.createElement("div");h.innerHTML=m;for(var g=h.children[0],p={},b=0;b<t.changedAttrs.length;b++)if("y"===t.changedAttrs[b]&&t.changedAttrs.indexOf("height")>=0){var y=(g.getAttribute("y")?parseFloat(g.getAttribute("y")):0)+(g.getAttribute("height")?parseFloat(g.getAttribute("height")):0);g.setAttribute("y",y),p.y=y}else if("d"===t.changedAttrs[b]){var v=void 0;g.getAttribute("d")&&(v=r.default.setPathDValue(g.getAttribute("d"),!0,0,0,f)),g.setAttribute("d",v),p.d=v}else"textContent"===t.changedAttrs[b]?(g.innerHTML="",p.textContent=""):"fill"===t.changedAttrs[b]||"stroke"===t.changedAttrs[b]?(void 0===g.getAttribute(t.changedAttrs[b])&&g.setAttribute(t.changedAttrs[b],"#FFFFFF"),p[t.changedAttrs[b]]=g.getAttribute(t.changedAttrs[b])):["x","y","cx","cy","x1","y1","x2","y2"].includes(t.changedAttrs[b])?"x2"===t.changedAttrs[b]?(g.setAttribute("x2",parseFloat(g.getAttribute("x1"))),p.x2=parseFloat(g.getAttribute("x1"))):"y2"===t.changedAttrs[b]?(g.setAttribute("y2",parseFloat(g.getAttribute("y1"))),p.y2=parseFloat(g.getAttribute("y1"))):p[t.changedAttrs[b]]=parseFloat(g.getAttribute(t.changedAttrs[b])):(g.setAttribute(t.changedAttrs[b],0),p[t.changedAttrs[b]]=0);m='<svg xmlns="http://www.w3.org/2000/svg" width="500" height="500">'+g.outerHTML+"</svg>";var A=(new DOMParser).parseFromString(m,"image/svg+xml").lastChild.children[0];t.charts[l].querySelector("#chartContent").appendChild(A),a.get(e[d])[l]=p}t.dataTrans=new Map;for(var k=0;k<e.length;k++){for(var T=a.get(e[k]),w=[],S=0;S<T.length;S++){for(var N={},x=0;x<t.changedAttrs.length;x++)N[t.changedAttrs[x]]=T[S][t.changedAttrs[x]];w.push(N)}t.dataTrans.set(e[k],w),t.charts[0].querySelector("#"+e[k]).setAttribute("data-transition",JSON.stringify({dataTrans:w},null,"\t"))}return t.charts[0]}},{key:"getBBoxes",value:function(){var t=document.getElementById("chartContainer").children[0].querySelectorAll('[id^="mark"]'),e=new Map;return t.length>0&&[].forEach.call(t,function(t){var a,r=t.getAttribute("id");"text"===t.tagName?(a=t.getBBox()).width+=10:a=t.getBBox(),e.set(r,a)}),e}},{key:"removeTransitions",value:function(e){var a=e.getAttribute("transform"),n=e.parentNode.getAttribute("trans").split(",");if(a){a=(a=a.replace(/translate|scale|rotate|\s/g,function(t){return" "===t?"":"@"+t})).replace(/(^@*)|(@*$)/g,"").split("@");for(var i="",o="",s=0;s<a.length;s++)a[s].indexOf("translate")>=0?o=a[s]:a[s].indexOf("scale")>=0&&(i=a[s]);var u=o.replace(/translate\(| |\)/g,"").split(",");e.setAttribute("transform",i),"g"===e.tagName?e.setAttribute("trans",parseFloat(u[0])+parseFloat(n[0])+","+(parseFloat(u[1])+parseFloat(n[1]))):r.default.transShape(e,parseFloat(u[0])+parseFloat(n[0]),parseFloat(u[1])+parseFloat(n[1]))}else"g"===e.tagName?e.setAttribute("trans",n.join(",")):r.default.transShape(e,parseFloat(n[0]),parseFloat(n[1]));if(e.children.length>0)for(var l=0;l<e.children.length;l++)t.removeTransitions(e.children[l])}},{key:"getMarkBBox",value:function(t){var e=new Map,a=t.querySelectorAll('[id^="mark"]');return a.length>0&&[].forEach.call(a,function(t){if("text"!==t.tagName)e.set(t.getAttribute("id"),t.getBBox());else{var a=t.getBBox();a.y-=a.height,a.width+=10,e.set(t.getAttribute("id"),a)}}),e}},{key:"processAnimateChart",value:function(t,e){var a=document.createElement("div");a.innerHTML=t;var r=a.children[0];r.setAttribute("id","visAnimation"),r.querySelector("#chartContent").setAttribute("id","aniChartContent");var n=r.querySelectorAll('[id^="mark"]');return n.length>0&&[].forEach.call(n,function(t){var a=t.getAttribute("id"),n=a.substring(4);t.setAttribute("id","ani"+a);var i=document.createElementNS("http://www.w3.org/2000/svg","mask");i.setAttributeNS(null,"id","animaskmark"+n);var o=document.createElementNS("http://www.w3.org/2000/svg","rect");o.setAttributeNS(null,"id","animaskBgmark"+n),o.setAttributeNS(null,"x",e.get(a).x-1),o.setAttributeNS(null,"y",e.get(a).y-1),o.setAttributeNS(null,"width",e.get(a).width+2),o.setAttributeNS(null,"height",e.get(a).height+2),o.setAttributeNS(null,"fill","#fff"),i.appendChild(o);var s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttributeNS(null,"x",-1e4),s.setAttributeNS(null,"y",-1e4),s.setAttributeNS(null,"width",2e4),s.setAttributeNS(null,"height",2e4),s.setAttributeNS(null,"fill","#fff"),i.appendChild(s),r.appendChild(i),t.setAttribute("mask","url(#animaskmark"+n+")")}),r}}],(a=null)&&o(e.prototype,a),i&&o(e,i),t}();s.charts=[],s.changedAttrs=[],s.dataTrans=new Map,s.markDoms=new Map;var u=s;e.default=u,t.exports=e.default},function(t,e,a){"use strict";function r(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){function t(e,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._type,this._views,this.views=a,this.type=e}var e,a,n;return e=t,(a=[{key:"type",set:function(e){void 0!==e&&(Object.keys(t.facetType).includes(e)?this._type=e:(console.log('the facet type has to be one of "row" or "column", setting to default value "column".'),this._type=t.facetType.col))},get:function(){return this._type}},{key:"views",set:function(t){if(void 0!==t){for(var e=t.map(function(t){if(void 0!==t.range){var e=new RegExp("\\d+$"),a=t.range[0].replace(e,""),r=t.range[1].replace(e,""),n=t.range[0].match(e),i=t.range[1].match(e);if(console.log(t.range[0],t.range[1],a,r,n,i),a===r){t.frames=[];for(var o=n;o<=i;o++)t.frames.push(a+o)}else t.frames=[t.range[0],t.range[1]],console.log("range start and end mismatch")}return t}),a=0,r=0;r<e.length;r++)e[r].frames.length>a&&(a=e[r].frames.length);for(var n=0;n<e.length;n++)if(e[n].frames.length<a)for(var i=e[n].frames[e[n].frames.length-1],o=a-e[n].frames.length;o>0;)e[n].frames.push(i),o--;this._views=e}},get:function(){return this._views}}])&&r(e.prototype,a),n&&r(e,n),t}();n.facetType={row:"row",col:"column"};var i=n;e.default=i,t.exports=e.default},function(t,e,a){var r=a(0),n=a(2),i=a(8),o=a(9);window.aniChart={frameRate:r.FRAME_RATE,duration:function(){return n.wholeEndTime},loadSpec:function(t,e){i.loadSpec(t,e)},renderSpec:function(t){var e=new i;e.init(t),e.render()},play:function(){o.play()},renderFrame:function(t){return o.renderFrame(t)},reset:function(){o.resetCover(),n.resetAll()},test:function(t){console.log("this is a test! ",t)}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,n=(r=a(0))&&r.__esModule?r:{default:r};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=function(t){function e(){var t;return o(this,e),(t=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))).chartIdx=0,t._type=e.actionTypes.appear,t.animationType="",t._easing=e.easingType.easeLinear,t._duration=0,t.startTime,t.attribute=function(){return function t(){o(this,t),this.attrName,this.from,this.to}}(),t}var a,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,n.default),a=e,c=[{key:"transToVisualAttrAction",value:function(t,a,r,i){for(var o=[],s=function(s){var u=r[s],l=[],c=[];i.forEach(function(t,e){if(a+1<t.length)if("d"===u||"textContent"===u||"fill"===u||"stroke"===u){var r=[e,t[a][u]?t[a][u]:"d"===u?"m0,0":t[a][u]],n=[e,t[a+1][u]?t[a+1][u]:"d"===u?"m0,0":t[a+1][u]];if("d"===u){var i=document.createElementNS("http://www.w3.org/2000/svg","path"),o=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttributeNS(null,"d",t[a][u]?t[a][u]:"m0,0"),o.setAttributeNS(null,"d",t[a+1][u]?t[a+1][u]:"m0,0");for(var s=i.getTotalLength()/300,f=o.getTotalLength()/300,d=[],m=[],h=0;h<300;h++){var g=i.getPointAtLength(s*h),p=o.getPointAtLength(f*h);d.push([g.x,g.y]),m.push([p.x,p.y])}r.push(d),n.push(m)}l.push(r),c.push(n)}else l.push([e,parseFloat(t[a][u])]),c.push([e,parseFloat(t[a+1][u])])});var f={chartIdx:t.chartIdx,reference:n.default.timingRef.previousStart,offset:0,duration:t.type===e.actionTypes.transition?t.duration:0,type:e.actionTargets.mark,animationType:e.targetAnimationType.custom,attribute:{attrName:u,from:l,to:c}};o.push(f)},u=0;u<r.length;u++)s(u);if(t.type!==e.actionTypes.transition){var l={chartIdx:t.chartIdx,reference:t.reference,offset:t.offset,easing:t.easing,duration:void 0===t.duration?300:t.duration,type:e.actionTargets.mask};switch(t.type){case e.actionTypes.fade:l.animationType=e.targetAnimationType.fade,l.attribute={attrName:"opacity",from:1,to:0};break;case e.actionTypes.fadeOut:l.animationType=e.targetAnimationType.fade,l.attribute={attrName:"opacity",from:0,to:1};break;case e.actionTypes.wipeBottom:l.animationType=e.targetAnimationType.wipe,l.attribute={attrName:"height",from:1,to:0};break;case e.actionTypes.wipeOutFromTop:l.animationType=e.targetAnimationType.wipe,l.attribute={attrName:"height",from:0,to:1};break;case e.actionTypes.wipeTop:l.animationType=e.targetAnimationType.move,l.attribute={attrName:"y",from:0,to:1};break;case e.actionTypes.wipeOutFromBottom:l.animationType=e.targetAnimationType.move,l.attribute={attrName:"y",from:1,to:0};break;case e.actionTypes.wipeLeft:l.animationType=e.targetAnimationType.move,l.attribute={attrName:"x",from:0,to:1};break;case e.actionTypes.wipeOutFromRight:l.animationType=e.targetAnimationType.move,l.attribute={attrName:"x",from:1,to:0};break;case e.actionTypes.wipeRight:l.animationType=e.targetAnimationType.wipe,l.attribute={attrName:"width",from:1,to:0};break;case e.actionTypes.wipeOutFromLeft:l.animationType=e.targetAnimationType.wipe,l.attribute={attrName:"width",from:0,to:1};break;case e.actionTypes.wheel:l.animationType=e.targetAnimationType.wheel,l.attribute={attrName:"startAngle",from:0,to:1};break;case e.actionTypes.wheelOut:l.animationType=e.targetAnimationType.wheel,l.attribute={attrName:"startAngle",from:1,to:0};break;case e.actionTypes.circle:l.animationType=e.targetAnimationType.circle,l.attribute={attrName:"innerRadius",from:0,to:1};break;case e.actionTypes.circleOut:l.animationType=e.targetAnimationType.circle,l.attribute={attrName:"innerRadius",from:1,to:0};break;case e.actionTypes.grow:l.type=e.actionTargets.mark,l.animationType=e.targetAnimationType.grow,l.attribute={attrName:"stroke-dashoffset",from:1,to:0};break;case e.actionTypes.degrow:l.type=e.actionTargets.mark,l.animationType=e.targetAnimationType.grow,l.attribute={attrName:"stroke-dashoffset",from:0,to:1};break;case e.actionTypes.appear:l.duration=1e3/n.default.FRAME_RATE,l.animationType=e.targetAnimationType.fade,l.attribute={attrName:"opacity",from:1,to:0};break;case e.actionTypes.zoom:l.type=e.actionTargets.mark,l.reference=n.default.timingRef.previousStart,l.offset=0,l.animationType=e.targetAnimationType.wipe,l.attribute={attrName:"width",from:0,to:1};var c={chartIdx:t.chartIdx,easing:t.easing,duration:void 0===t.duration?300:t.duration,reference:t.reference,offset:t.offset,type:e.actionTargets.mask,animationType:e.targetAnimationType.wipe,attribute:{attrName:"height",from:1,to:0}};o.push(c);break;case e.actionTypes.custom:l.type=e.actionTargets.mark,l.animationType=e.targetAnimationType.custom,l.attribute={},void 0!==t.attribute&&(l.attribute={attrName:t.attribute.attrName,from:t.attribute.from,to:t.attribute.to})}o.push(l)}return o}},{key:"calActionDuration",value:function(t,a,r){for(var n=0,o=-1e5,s=0,u=0,l=!1,c=function(a){var c=void 0,f=new Map;c=t[a].calOffsetTime(s,u,0,r),a>0&&t[a-1].animationType===e.targetAnimationType.mistake&&c.forEach(function(e,r){c.set(r,e-t[a-1].offset)});var d=1e6,m=-1e5;t[a].offsetStart=new Map,c.forEach(function(e,r){var s=0;"object"===i(t[a].duration)?(l=!0,s=e):"number"==typeof t[a].duration&&(s=e+t[a].duration),f.set(r,s),t[a].offsetStart.set(r,e),e<d&&(d=e),s>m&&(m=s),e<n&&(n=e),s>o&&(o=s)}),s=d,u=m},f=0;f<t.length;f++)c(f);var d=o-n,m=new Map,h=new Map;return l?(a.forEach(function(t,e){t.forEach(function(t,e){(void 0===h.get(e)||t[0]<h.get(e))&&h.set(e,t[0])})}),a.forEach(function(t,e){var a=0;t.forEach(function(t,e){var r=h.get(e);a+=t[1]*t[0]/r}),m.set(e,d+a)})):a.forEach(function(t,e){m.set(e,d)}),[m,h,t]}}],(r=[{key:"initAction",value:function(t){this.chartIdx=t.chartIdx,this.type=t.type,this.animationType=t.animationType,this.reference=t.reference,this.offset=t.offset,this.duration=t.duration,this.easing=t.easing,void 0!==t.attribute&&(this.attribute.attrName=t.attribute.attrName,this.attribute.from=t.attribute.from,this.attribute.to=t.attribute.to)}},{key:"type",set:function(t){void 0!==t&&(Object.keys(e.actionTypes).includes(t)?this._type=t:alert("the 'type' of action is not defined. "))},get:function(){return this._type}},{key:"easing",set:function(t){void 0!==t&&(Object.keys(e.easingType).includes(t)?this._easing=t:alert("the 'easing' of action is not defined. "))},get:function(){return this._easing}},{key:"duration",set:function(t){void 0!==t&&(this._duration="number"==typeof t?Math.floor(t/(1e3/n.default.FRAME_RATE))*(1e3/n.default.FRAME_RATE):t)},get:function(){return this._duration}}])&&s(a.prototype,r),c&&s(a,c),e}();c.actionTypes={fade:"fade",wipeBottom:"wipe bottom",wipeTop:"wipe top",wipeLeft:"wipe left",wipeRight:"wipe right",wheel:"wheel",appear:"appear",circle:"circle",grow:"grow",custom:"custom",fadeOut:"fade out",wipeOutFromLeft:"wipe out from left",wipeOutFromTop:"wipe out from top",wipeOutFromRight:"wipe out from right",wipeOutFromBottom:"wipe out from bottom",wheelOut:"wheel out",circleOut:"circle out",degrow:"degrow",transition:"magic move",zoom:"zoom",mark:"mask",mask:"mark"},c.actionTargets={mark:"mark",mask:"mask"},c.targetAnimationType={fade:"fade",wipe:"wipe",move:"move",wheel:"wheel",circle:"circle",appear:"appear",grow:"grow",custom:"custom",mistake:"mistake"},c.easingType={easeLinear:"easeLinear",easeInQuad:"easeInQuad",easeOutQuad:"easeOutQuad",easeInOutQuad:"easeInOutQuad",easeInCubic:"easeInCubic",easeOutCubic:"easeOutCubic",easeInOutCubic:"easeInOutCubic",easeOutBounce:"easeOutBounce"};var f=c;e.default=f,t.exports=e.default},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,n=(r=a(0))&&r.__esModule?r:{default:r};function i(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){function e(){var t;return s(this,e),(t=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)))._groupBy="id",t._reference=n.default.timingRef.previousStart,t._delay=0,t.sort=function(){return function t(){s(this,t),this.field,this.order,this.expr}}(),t.grouping,t}var a,r,f;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,n.default),a=e,(r=[{key:"initGrouping",value:function(t){this.groupBy=t.groupBy,this.reference=t.reference,this.delay=t.delay,void 0!==t.sort&&(this.sort.field=t.sort.field,this.sort.order=t.sort.order,this.sort.expr=t.sort.expr),void 0!==t.grouping?(this.grouping=new e,this.grouping.initGrouping(t.grouping)):void 0===t.grouping&&"id"!==t.groupBy&&(this.grouping=new e,this.grouping.groupBy="id")}},{key:"arrangeOrder",value:function(t,e){var a={groupRef:"root",children:[]};return a.marks=t,this.generateTree(a,e),this.getMarkOrder(a)}},{key:"generateTree",value:function(t,a){for(var r,n=this.groupBy,s=new Map,u=0;u<t.marks.length|(r=t.marks[u]);u++){var l=a.get(r)["data-datum"],c=void 0;if(void 0!==a.get(r)[n])c=a.get(r)[n];else{if(void 0!==a.get(r)[n]||void 0===l[n])return void console.log("error: grouping by an unknown attribute");c=l[n]}if(void 0!==s.get(c))s.get(c).marks.push(r);else{var f={};f.groupRef=n,f.refValue=c,f.children=[],f.marks=[r],s.set(c,f)}}switch(o(this.sort.order)){case"object":for(var d,m=0;m<this.sort.order.length|(d=this.sort.order[m]);m++)void 0!==s.get(d)&&t.children.push(s.get(d));break;case"string":var h=!0;if(s.forEach(function(t,e){t.marks.length>1&&(h=!1)}),void 0!==this.sort.field&&h){var g=this.sort.field,p=[].concat(i(s)),b=this.sort.order;p.sort(function(t,r){var n=t[1].marks[0],i=r[1].marks[0],o="",s="",u=a.get(n)["data-datum"],l=a.get(i)["data-datum"];return void 0!==a.get(n)[g]&&"undefined"!==a.get(i)[g]?(o=a.get(n)[g],s=a.get(i)[g]):void 0===a.get(n)[g]&&void 0!==u[g]&&void 0===a.get(i)[g]&&void 0!==l[g]&&(o=u[g],s=l[g]),isNaN(parseFloat(o))||(o=parseFloat(o)),isNaN(parseFloat(s))||(s=parseFloat(s)),b===e.orderTypes.ascending?o>=s?1:-1:b===e.orderTypes.descending?s>=o?1:-1:b===e.orderTypes.random?Math.random()>=.5?1:-1:void 0});for(var y,v=0;v<p.length|(y=p[v]);v++)t.children.push(y[1])}else{var A=[].concat(i(s));this.sort.order===e.orderTypes.ascending?A.sort(function(t,e){return t[0]>=e[0]?1:-1}):this.sort.order===e.orderTypes.descending?A.sort(function(t,e){return e[0]>=t[0]?1:-1}):this.sort.order===e.orderTypes.random&&A.sort(function(t,e){return Math.random()>=.5?1:-1});for(var k,T=0;T<A.length|(k=A[T]);T++)t.children.push(k[1])}break;default:s.forEach(function(e,a){t.children.push(e)})}if(void 0!==this.grouping)for(var w,S=0;S<t.children.length|(w=t.children[S]);S++)this.grouping.generateTree(w,a)}},{key:"getMarkOrder",value:function(t){var e=[];if(null!=t){var a=[];for(a.unshift(t);0!=a.length;){var r=a.shift(),n=r.children;if(n.length<=0)e=[].concat(i(e),i(r.marks));else for(var o=0;o<n.length;o++)a.push(n[o])}}return e}},{key:"calTimeInGrouping",value:function(t,e){var a=this.groupBy,r=new Map;if(t.forEach(function(t,n){var i=e.get(n)["data-datum"];void 0!==e.get(n)[a]?r.set(n,e.get(n)[a]):void 0===e.get(n)[a]&&void 0!==i[a]?r.set(n,i[a]):console.log("error: grouping by an unknown attribute")}),void 0!==this.grouping){this.grouping.calTimeInGrouping(t,e);for(var o,s,u=[].concat(i(r)),l="",c=new Array,f=new Map,d=0;d<u.length;d++){var m=u[d][0],h=u[d][1];h!==l&&(this.updateGroupingTime(o,s,f,c,t),o=c[0],s=c[c.length-1],f=c,c=[],l=h),c.push(m)}this.updateGroupingTime(o,s,f,c,t)}else{var g=[].concat(i(t.entries()));g[0][1].startTime=0;for(var p=1;p<g.length;p++){var b=void 0,y=g[p-1][1].startTime,v=y+g[p-1][1].totalDuration;switch(this.reference){case n.default.timingRef.previousStart:b=y+this.delay;break;case n.default.timingRef.previousEnd:b=v+this.delay;break;case n.default.timingRef.absolute:b=this.delay;break;default:b=y+this.delay}g[p][1].startTime=b,t.set(g[p][0],g[p][1])}}}},{key:"updateGroupingTime",value:function(t,e,a,r,i){for(var o,s,u=-1e4,l=0;l<a.length|(s=a[l]);l++)i.get(s).startTime+i.get(s).totalDuration>u&&(u=i.get(s).startTime+i.get(s).totalDuration,o=s);if(void 0!==t&&void 0!==o){var c=0;switch(this.reference){case n.default.timingRef.previousStart:c=i.get(t).startTime-i.get(r[0]).startTime+this.delay;break;case n.default.timingRef.previousEnd:c=i.get(o).startTime+i.get(o).totalDuration-i.get(r[0]).startTime+this.delay;break;case n.default.timingRef.absolute:c=this.delay-i.get(r[0]).startTime}for(var f,d=0;d<r.length|(f=r[d]);d++)i.get(f).startTime+=c}}},{key:"groupBy",set:function(t){void 0!==t&&(this._groupBy=t)},get:function(){return this._groupBy}},{key:"reference",set:function(t){if(void 0!==t){var e=n.default.transRef(t);Object.keys(n.default.timingRef).includes(e)?this._reference=t:alert("the 'reference' of TimingSpec has to be one of 'previousStart', 'previousEnd' or 'absolute'. ")}},get:function(){return this._reference}},{key:"delay",set:function(t){void 0!==t&&(t>=1e3/n.default.FRAME_RATE||0===t?this._delay=t:this._delay=1e3/n.default.FRAME_RATE)},get:function(){return this._delay}}])&&u(a.prototype,r),f&&u(a,f),e}();f.orderTypes={ascending:"ascending",descending:"descending",random:"random"};var d=f;e.default=d,t.exports=e.default},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=u(a(3)),n=u(a(4)),i=u(a(0)),o=u(a(2)),s=u(a(1));function u(t){return t&&t.__esModule?t:{default:t}}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.chartSpecs,this.facet,this._animations}var e,a,u;return e=t,u=[{key:"loadSpec",value:function(t,e){var a=new XMLHttpRequest,r="file:"===document.location.protocol?0:200;if(a.open("GET",t,!1),a.overrideMimeType("text/html;charset=utf-8"),a.send(null),a.status===r){var n=a.responseText;e(JSON.parse(n))}else 404===a.status&&console.log("can not find "+t+" ! Please check the url.")}}],(a=[{key:"init",value:function(t){var e=this;this.chartSpecs=[];var a=t;a.charts=r.default.chartPreProcessing(a.charts);for(var i=0;i<a.charts.length;i++){var u=void 0===a.charts[i].id?"chart"+i:a.charts[i].id,c=new r.default(u,a.charts[i].source);this.chartSpecs.push(c)}a.facet&&(this.facet=new n.default(a.facet.type,a.facet.views)),r.default.loadCharts(this.chartSpecs,this.facet);var f=r.default.removeTransAndMerge();document.getElementById("chartContainer").innerHTML="",document.getElementById("chartContainer").appendChild(f);var d=r.default.getBBoxes(),m=r.default.processAnimateChart(document.getElementById("chartContainer").innerHTML,d);if(document.getElementById("videoContainer").innerHTML="",document.getElementById("videoContainer").appendChild(m),this.animations=a.animations,Array.isArray(this.animations))for(var h,g=function(t){var a=e.animations[t],n=document.createElement("div");document.body.appendChild(n),n.innerHTML=r.default.charts[a.chartIdx].outerHTML;for(var i=n.querySelectorAll(a.selection),u=[],c=0;c<r.default.changedAttrs.length;c++)u.push(r.default.changedAttrs[c]);var f=new o.default;f.translate(a,u);var d=[];i.length>0&&[].forEach.call(i,function(t){if(t.classList.contains("mark")){var e=t.getAttribute("id");if(d.push(e),"path"===t.tagName){var a=s.default.toJSON(t),r=s.default.discretizePath(a);if(r){if("lines"===r.type)for(var n=0;n<r.data.length;n++)a.attr["x"+(1+2*n)]=r.data[n][0][0],a.attr["y"+(1+2*n)]=r.data[n][0][1],a.attr["x"+(2+2*n)]=r.data[n][1][0],a.attr["y"+(2+2*n)]=r.data[n][1][1];else for(var i=Object.keys(r.data),o=0;o<i.length;o++){var u=i[o];"radius"===u?r.data[u].length>1?(a.attr.innerRadius=r.data[u][0].rx+1,a.attr.outterRadius=r.data[u][1].rx-1):(a.attr.innerRadius=0,a.attr.outterRadius=r.data[u][0].rx-1):a.attr[u]=r.data[u]}t=s.default.toDOM(a)}}for(var c={},m=[].concat(l(t.attributes)),h=0;h<m.length;h++){var g=m[h];c[g.name]=t.getAttribute(g.name)}var p=document.getElementById(e);c.bbWidth=p.getBBox().width,c.bbHeight=p.getBBox().height,c.bbX=p.getBBox().x,c.bbY=p.getBBox().y,c.content=t.textContent,c.id=e;var b=JSON.parse(t.getAttribute("data-datum"));Array.isArray(b)&&(b=b[0]),c["data-datum"]=b,"path"!==t.tagName&&"line"!==t.tagName||(c["stroke-dasharray"]=document.getElementById(e).getTotalLength(),c["stroke-dashoffset"]=document.getElementById(e).getTotalLength()),f.domMarks.set(e,c)}}),f.calAniTime(d,h),h=f,document.body.removeChild(n)},p=0;p<this.animations.length;p++)g(p)}},{key:"render",value:function(){o.default.renderAnimation()}},{key:"animations",set:function(t){var e=t.map(function(t){return t.chartIdx=0,t}),a=0;if((a=this.facet?this.facet.views[0].frames.length:this.chartSpecs.length)>1)for(var r=function(a){var r=s.default.deepClone(t);r[0].reference=i.default.timingRef.previousEnd;var n=r.map(function(t){return t.chartIdx=a,t});e.push.apply(e,l(n))},n=1;n<a-1;n++)r(n);this._animations=e},get:function(){return this._animations}}])&&c(e.prototype,a),u&&c(e,u),t}();e.default=f,t.exports=e.default},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(a(0)),n=o(a(2)),i=o(a(1));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,a,o;return e=t,o=[{key:"renderFrame",value:function(e){var a=n.default.renderFrame(e);if(void 0===a)return!1;for(var r,o=function(e,a){a[1].forEach(function(e,r){var n="";if("mark"===e.type){switch(n="ani"+a[0],e.attrName){case"textContent":if(i.default.checkHTML(e.value)){var o=i.default.strToDomNode(e.value);document.getElementById(n).appendChild(o)}else document.getElementById(n).innerHTML=e.value,document.getElementById(n).textContent=e.value;break;case"stroke-dashoffset":document.getElementById(n).setAttributeNS(null,"stroke-dasharray",document.getElementById(n).getTotalLength()),document.getElementById(n).setAttributeNS(null,e.attrName,e.value);break;case"x":case"y":document.getElementById(n).setAttributeNS(null,e.attrName,e.value),document.getElementById("animaskCover"+a[0])&&("y"===e.attrName&&"text"===document.getElementById(a[0]).tagName?document.getElementById("animaskCover"+a[0]).setAttributeNS(null,e.attrName,e.value-parseFloat(document.getElementById("animaskBg"+a[0]).getAttributeNS(null,"height"))):document.getElementById("animaskCover"+a[0]).setAttributeNS(null,e.attrName,e.value)),document.getElementById(n).setAttributeNS(null,e.attrName,e.value);break;default:document.getElementById(n).setAttributeNS(null,e.attrName,e.value)}var s="animaskBg"+a[0],u=document.getElementById(n).getBBox();document.getElementById(s).setAttributeNS(null,"x",u.x-1),document.getElementById(s).setAttributeNS(null,"y",u.y-1),document.getElementById(s).setAttributeNS(null,"width",u.width+2),document.getElementById(s).setAttributeNS(null,"height",u.height+2)}else if("mask"===e.type){n="animask"+a[0];var l=document.querySelectorAll("#"+n+' [id^="animaskCover"]');switch(e.animationType){case"fade":case"move":case"wipe":case"custom":if(l.length>0){var c=document.getElementById("animaskCover"+a[0]);if("rect"!==c.getAttribute("maskType")){c.parentNode.removeChild(c);var f=t.generateMaskCover(t.coverTypes.rect,a[0],e.attrName,e.value);document.getElementById(n).appendChild(f)}else document.getElementById("animaskCover"+a[0]).setAttributeNS(null,e.attrName,e.value)}else{var d=t.generateMaskCover(t.coverTypes.rect,a[0],e.attrName,e.value);document.getElementById(n).appendChild(d)}break;case"circle":case"wheel":var m=i.default.arc(e.value.cx,e.value.cy,e.value.innerRadius,e.value.outterRadius-6,e.value.startAngle,e.value.endAngle);if(l.length>0){var h=document.getElementById("animaskCover"+a[0]);if("wedge"!==h.getAttribute("maskType")){h.parentNode.removeChild(h);var g=t.generateMaskCover(t.coverTypes.path,a[0],"d",m);document.getElementById(n).appendChild(g)}else document.getElementById("animaskCover"+a[0]).setAttributeNS(null,"d",m)}else{var p=t.generateMaskCover(t.coverTypes.path,a[0],"d",m);document.getElementById(n).appendChild(p)}break;case"mistake":l.length>0&&document.getElementById("animaskCover"+a[0]).setAttributeNS(null,e.attrName,e.value)}}else console.log("this status has no type")})},s=0;s<a.length|(r=a[s]);s++)o(0,r);return!0}},{key:"generateMaskCover",value:function(e,a,r,n){var i;switch(e){case t.coverTypes.rect:(i=document.createElementNS("http://www.w3.org/2000/svg","rect")).setAttributeNS(null,"maskType","rect"),i.setAttributeNS(null,"x",document.getElementById("animaskBg"+a).getAttribute("x")),i.setAttributeNS(null,"y",document.getElementById("animaskBg"+a).getAttribute("y")),i.setAttributeNS(null,"width",document.getElementById("animaskBg"+a).getAttribute("width")),i.setAttributeNS(null,"height",document.getElementById("animaskBg"+a).getAttribute("height"));break;case t.coverTypes.path:(i=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttributeNS(null,"maskType","wedge"),document.getElementById(a).getAttribute("transform")&&i.setAttributeNS(null,"tranform",document.getElementById(a).getAttribute("transform"))}return i.setAttributeNS(null,"id","animaskCover"+a),i.setAttributeNS(null,"fill","#000"),i.setAttributeNS(null,"stroke","#000"),i.setAttributeNS(null,"stroke-width",4),"stroke"!==r&&i.setAttributeNS(null,r,n),i}},{key:"resetCover",value:function(){var t=document.querySelectorAll('[id^="animaskCover"]');t.length>0&&[].forEach.call(t,function(t){t.parentNode.removeChild(t)})}},{key:"play",value:function(){var t=this,e=0,a=setInterval(function(){e=parseInt(e/(1e3/r.default.FRAME_RATE))*(1e3/r.default.FRAME_RATE);var i=t.renderFrame(e);((e+=1e3/r.default.FRAME_RATE)>n.default.wholeEndTime||!i)&&(clearInterval(a),a="undefined",e=0)},1e3/r.default.FRAME_RATE)}}],(a=null)&&s(e.prototype,a),o&&s(e,o),t}();u.coverTypes={rect:Symbol(),path:Symbol()};var l=u;e.default=l,t.exports=e.default}])});
//# sourceMappingURL=anichart.min.js.map